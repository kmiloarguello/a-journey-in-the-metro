<!--xs-->
<html><head>
  <meta http-equiv="content-type" content="text/html; charset=windows-1252">
  <title></title>
</head>

<body vlink="#307777" text="#000000" link="#A02020" lang="en" bgcolor="#F9F9F9">
<h1 align="center">MorphoGraph and Imagery - Practical session 3</h1>

<h3 align="center">from an <a href="http://www.esiee.fr/~coupriem/Graphestp3/graphestp3.html">original
subject</a> in French by Michel Couprie, Gilles Bertrand</h3>
<hr>

<p></p>

<h2>Preliminaries</h2>

<p>First of all, get the file <a href="https://perso.esiee.fr/~coustyj/EnglishMorphoGraph/graphestp3.tar.gz">graphestp3.tar.gz</a>
and uncompress it&nbsp;: </p>
<pre>    gunzip graphestp3.tar.gz
    tar xvf graphestp3.tar
    rm graphestp3.tar
    cd GraphesTp3; ls</pre>

<p>This archive contains C programs for manipulating graphs. Documentation of
these programs can be found here:</p>

<p></p>

<center>
<a href="http://www.esiee.fr/~coupriem/Graphesdoc/index.html"><b>Documentation</b></a></center>

<p></p>

<p>Reminder on the two first practical sessions: <a href="http://www.esiee.fr/~coupriem/Graphestp3/gamma.html">description of the
data structures</a> used to represent a graph by &#915; (its successors map).
Also remind to refer to the documentation of the source code, including:</p>
<ul>
  <li><a href="http://www.esiee.fr/~coupriem/Graphesdoc/graphes_8h-source.html">source
    of the definition of the main data structures (graphe, cell...)</a></li>
  <li><a href="http://www.esiee.fr/~coupriem/Graphesdoc/graph__basic_8c.html">description
    of basic functions to handle graphs</a> (see in particular AjouteArc
    -meaning AddArc in French -, EstSuccesseur - meaning IsSuccessor in
  French)</li>
  <li><a href="http://www.esiee.fr/~coupriem/Graphesdoc/graphaux_8c.html">description
    of the functions to handle lists (LIFO) and Boolean arrays</a> (see in
    particular CreeLifoVide - meaning CreateEmptyLifo in French-, EnsembleVide
    - meaning EmptySet in French)</li>
</ul>

<p></p>

<p></p>
<hr>

<p></p>

<h1 align="center">A journey in the metro</h1>

<p></p>

<table border="0" align="center">
  <tbody>
    <tr>
      <td align="center"><img src="PS3_files/metro.gif"></td>
    </tr>
  </tbody>
</table>

<p>The <a href="http://www.ratp.fr/">RATP</a> (public transportation company in
Paris) provides its users with an interactive service that finds the shortest
route between two subway stations chosen by the user. Our goal in this session
is the design and development of a simplified version of such software. We will
also consider the most effective strategies to solve problems of the same
type.</p>

<p></p>
<hr width="100%" size="5">

<p></p>

<p><b>0. The data </b> </p>

<p></p>

<p>You will find in the file <a href="http://www.esiee.fr/~coupriem/Graphestp3/metro_complet.graph">metro_complet.graph</a>
a network constructed as follows:</p>
<ul>
  <li>Each vertex corresponds to a station for a given line (eg Republic [line
    3] and Republic [line 5] are two distinct vertices).</li>
  <li>To each vertex is associated the position of a station on a map (scale: 1
    ~ 25.7m).</li>
  <li>To each vertex is associated a station name (string).</li>
  <li>Two vertices form a directed arc if the associated stations are directly
    linked by metro (the graph is not symmetric because of some "one way"
    tunnels, for example around Porte d'Auteuil). This arc is weighted by the
    estimated time in seconds to travel from one station to the other (taking
    as a basis an average speed of 10m / s or 36km / h).</li>
  <li>Two vertices are linked to each other by two symmetric arcs if one can
    walk between the corresponding stations without buying a new ticket. These
    arcs are then weighted by an estimation of the average waiting and walking
    time (120s).</li>
</ul>

<p>Visualize the graph of Paris metro, using the programs
<strong>graphe2ps.exe</strong> and display:</p>
<pre>    make graphe2ps.exe
    graphe2ps.exe metro_complet.graph
    display metro_complet.graph.eps</pre>

<p></p>
<hr width="100%" size="5">

<p></p>

<p><b>1. Dijkstra in the metro </b> </p>

<p>Implement Dijkstra algorithm studied in course
(see <a href="http://www.esiee.fr/~coustyj/EnglishMorphoGraph/L4.pdf">
    lecture 4</a>, slide 15). Find
below a short description of the requested function: </p>
<pre>/* ====================================================================== */
/*! \fn void Dijkstra(graphe * g, int x)
    \param g (entrée) : a network. The length of each arc must be stored in
                        the field v_arc of the structure cell.
    \param x (entrée) : a vertex of g.
    \brief compute, for each vertex y of g, the length Dx(y)of a shortest path
           from x to y. This length is stored in the field 
           v_sommets of the structure g.
*/
/* ====================================================================== */
</pre>

<p>Test your program on a small graph of your choice (<a href="http://www.esiee.fr/~coupriem/Graphestp3/test_dijkstra.graph">this one
for instance</a>), then on the graph of the metro. </p>

<p>Useful functions: </p>
<ul>
  <li><a href="http://www.esiee.fr/~coupriem/Graphesdoc/graphaux_8c.html#a22">EnsembleVide()</a></li>
  <li>The type of the values associated to the arcs and to the
    vertices is <b>long</b> (see definitions
    in <a href="http://www.esiee.fr/~coupriem/Graphesdoc/graphes_8h.html">graphes.h</a>).
    We can use the constant LONG_MAX for infinity. </li>
</ul>

<p></p>
<hr width="100%" size="5">

<p></p>

<p><b>2. Shortest path</b> </p>

<p>Implement an algorithm (based on the values returned by Dijkstra) for
computing a shortest path from a vertex <b>x</b> to a vertex <b>y</b>. Find
below a short description of the requested function:</p>
<pre>/* ====================================================================== */
/*! \fn graphe * SP(graphe * g, int x, int y)
    \param g (entrée) : a network. The length of each arc must be stored in
                        the field v_arc of the structure cell.
    \param x (entrée) : a vertex of g (start).
    \param y (entrée) : a vertex of g (arrival).
    \return a shortest path from x to y in g.
    \brief returns a shortest path from x to y in g.
*/
/* ====================================================================== */
</pre>

<p>Computation time can be improved by terminating Dijkstra when the vertex
<b>y</b> is reached. </p>

<p>Test your program on a small graph of your choice, then on the
graph of the metro. Visualize
(see <a href="http://www.esiee.fr/~coupriem/Graphesdoc/graph__print_8c.html#a6">EPSGraphe</a>)
the obtained shortest path for a few trips in the metro. </p>

<p>Useful functions: </p>
<ul>
  <li><a href="http://www.esiee.fr/~coupriem/Graphesdoc/graph__basic_8c.html#a6">InitGraphe()</a></li>
  <li><a href="http://www.esiee.fr/~coupriem/Graphesdoc/graph__algos_8c.html#a1">Symetrique()</a></li>
  <li><a href="http://www.esiee.fr/~coupriem/Graphesdoc/graph__basic_8c.html#a9">AjouteArc()</a></li>
</ul>

<p></p>
<hr width="100%" size="5">

<p></p>

<p><b>3. Improvement of Dijkstra</b> </p>

<p>In Dijkstra algorithm, the vertices of <b>S\</b> can be divide into two
subsets: </p>
<ul>
  <li>Set <b>T</b> that contains the vertices of <b>S</b> whose current value
    is finite; and</li>
  <li>Set <b>U</b> that contains the vertices of <b>S</b> whose current value
    is infinite.</li>
</ul>

<p>In the basic version of Dijkstra algorithm, we search for vertex of minimum
value in [<b>T</b> union <b>U</b>]. The algorithm can be significantly improved
by introducing a variable that represent the set <b>T</b> (as a list) in order
to restrain the search to that set. </p>

<p>Implement this improvement and test it. </p>

<p>Useful data structures and functions found in the graphaux.h and
  graphaux.c files: </p>
<ul>
  <li> ListeChainee, LCell, ListeVide(), ajouteElmt(), supprimeLCell(),
  afficheListe(), estListeVide()</li>
  <li> The usages of these functions can be found in the file
  graphaux.c </li>
  <li> An example of use of these data structures and functions is
  available in the file testeListeChainee.c </li>
</ul>

<p></p>
<hr width="100%" size="5">

<p></p>

<h1>Bonus (homework to be done after the session)</h1>

<p><b>4. Improving the estimation of the time of the journey</b> </p>

<p>In the previous method, we do not take into account the time taken by the
metro when it stops at a station. We would like to add to the estimation of the
total time of the route an average waiting time of 20s for each stop. To this
end, there exist two kinds of solutions: </p>
<ul>
  <li>by modifying the network,</li>
  <li>by modifying the algorithm.</li>
</ul>

<p>Explain how to proceed in each case (no implementation is required). </p>
<hr width="100%" size="5">

<p><b>Acknowledgement</b> </p>

<p>We thank RATP for the data available on its web site. We also thank L.
Granboulan and L. Mauborgne from ENS, authors of a <a href="http://www.di.ens.fr/~granboul/enseignement/mmfai/algo2001-2002/tp7/">Practical
Session on finding shortest path in the metro</a> which inspired the subject of
this practical session. </p>

<p></p>

<p></p>

<p></p>

<p></p>


</body></html>